source_set("libgrapheme") {
  # Due to GN's ordering, we set C99 this way instead of through `cflags_c` directly.
  # This sets C99 *after* the default compiler config. Using cflags_c sets C99 before the default.
  configs += [ "//build/config/compiler:c99" ]

  sources = [
    "src/bidirectional.c",
    "src/case.c",
    "src/character.c",
    "src/line.c",
    "src/sentence.c",
    "src/utf8.c",
    "src/util.c",
    "src/word.c",
  ]
}

declare_args() {
  UNICODE_VERSION = "15.0.0"
}

copy("copy_unicode_data") {
  unicode_ucd_dir = "//third_party/unicode/ucd/$UNICODE_VERSION"
  sources = [
    "$unicode_ucd_dir/BidiBrackets.txt",
    "$unicode_ucd_dir/BidiMirroring.txt",
    "$unicode_ucd_dir/DerivedCoreProperties.txt",
    "$unicode_ucd_dir/EastAsianWidth.txt",
    "$unicode_ucd_dir/LineBreak.txt",
    "$unicode_ucd_dir/SpecialCasing.txt",
    "$unicode_ucd_dir/UnicodeData.txt",
    "$unicode_ucd_dir/auxiliary/GraphemeBreakProperty.txt",
    "$unicode_ucd_dir/auxiliary/SentenceBreakProperty.txt",
    "$unicode_ucd_dir/auxiliary/WordBreakProperty.txt",
    "$unicode_ucd_dir/emoji/emoji-data.txt",
    "$unicode_ucd_dir/extracted/DerivedBidiClass.txt",
  ]
  outputs =
      [ "$root_gen_dir/third_party/libgrapheme/data/{{source_file_part}}" ]
}
